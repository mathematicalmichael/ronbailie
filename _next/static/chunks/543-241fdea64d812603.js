"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[543],{7543:(e,t,r)=>{r.d(t,{default:()=>c});var n=r(5155),a=r(2115),s=r(337),l=r(7274),i=r(3451);let u=e=>{let{data:t,height:r=50,color:a="#9ca3af"}=e;if(!t||t.length<2)return(0,n.jsx)("svg",{width:"100%",height:r,viewBox:"0 0 ".concat(450," ").concat(r),className:"bg-gray-800 rounded border border-gray-700",children:(0,n.jsx)("text",{x:225,y:r/2,fill:"#9ca3af",textAnchor:"middle",dy:".3em",fontSize:"10",children:"Waiting for data..."})});let s=r-10,l=Math.max(...t),i=Math.min(...t),u=Math.min(.1*(l-i),.5*l+1e-5),c=l+u,o=Math.max(0,i-u),d=Math.max((c=Math.max(c,1e-8))-o,1e-7),m=t.map((e,n)=>{let a=5+n/(t.length-1)*440,l=r-5-(e-o)/d*s,i=Math.max(5,Math.min(r-5,l));return"".concat(a.toFixed(2),",").concat(i.toFixed(2))}).join(" "),h=e=>0===e?"0":.001>Math.abs(e)||Math.abs(e)>=1e4?e.toExponential(1):.1>Math.abs(e)?e.toPrecision(1):e.toFixed(1),p=h(c),f=h(o);return(0,n.jsxs)("svg",{width:"100%",height:r,viewBox:"0 0 ".concat(450," ").concat(r),className:"bg-gray-800 rounded border border-gray-700",children:[(0,n.jsx)("text",{x:8,y:9,fill:"#9ca3af",fontSize:"8",textAnchor:"start",dy:".3em",children:p}),(0,n.jsx)("text",{x:8,y:r-5,fill:"#9ca3af",fontSize:"8",textAnchor:"start",dy:".3em",children:f}),(0,n.jsx)("polyline",{points:m,fill:"none",stroke:a,strokeWidth:"1.5"})]})};function c(){let e=(0,a.useRef)(null),t=(0,a.useRef)(null),r=(0,a.useRef)(null),c=(0,a.useRef)(null),o=(0,a.useRef)(null),d=(0,a.useRef)(null),m=(0,a.useRef)(null),h=(0,a.useRef)(null),p=(0,a.useRef)(null),f=(0,a.useRef)(null),x=(0,a.useRef)(new Set),g=(0,a.useRef)(!1),y=(0,a.useRef)(-1),b=(0,a.useRef)(null),[w,v]=(0,a.useState)([]),[j,N]=(0,a.useState)(.1),[M,E]=(0,a.useState)(.009),[F,R]=(0,a.useState)(1),[S,C]=(0,a.useState)(.1),k=(0,a.useRef)(j),z=(0,a.useRef)(M),A=(0,a.useRef)(F),L=(0,a.useRef)(S);(0,a.useEffect)(()=>{k.current=j},[j]),(0,a.useEffect)(()=>{z.current=M},[M]),(0,a.useEffect)(()=>{A.current=F},[F]),(0,a.useEffect)(()=>{L.current=S},[S]);let P=e=>{var n;if(!t.current||!o.current||!c.current||!m.current||!x.current||!r.current)return;let a=t.current.domElement.getBoundingClientRect(),l=new s.I9Y;l.x=(e.clientX-a.left)/a.width*2-1,l.y=-(2*((e.clientY-a.top)/a.height))+1;let i=new s.tBo;i.params.Points.threshold=.5,i.setFromCamera(l,o.current);let u=null===(n=c.current)||void 0===n?void 0:n.children.find(e=>e instanceof s.ONl);if(!u)return;let d=i.intersectObject(u);if(d.length>0){let e=3*d[0].index;x.current.has(e)||(g.current=!0,r.current.enabled=!1,y.current=e)}},U=e=>{if(!g.current||-1===y.current||!t.current||!o.current||!d.current||!m.current||!p.current||!h.current)return;let r=t.current.domElement.getBoundingClientRect(),n=new s.I9Y;n.x=(e.clientX-r.left)/r.width*2-1,n.y=-(2*((e.clientY-r.top)/r.height))+1;let a=new s.tBo;a.params.Points.threshold=.5,a.setFromCamera(n,o.current);let l=new s.Pq0(0,0,1),i=new s.Zcv(l,0),u=new s.Pq0;if(a.ray.intersectPlane(i,u)){let e=p.current[y.current],t=p.current[y.current+1],r=u.x-e,n=u.y-t,a=Math.sqrt(r*r+n*n);if(a>L.current){let s=L.current/a;u.x=e+r*s,u.y=t+n*s}let l=d.current.attributes.position.array,i=m.current.attributes.position.array;l[y.current]=u.x,l[y.current+1]=u.y,i[y.current]=u.x,i[y.current+1]=u.y,d.current.attributes.position.needsUpdate=!0,m.current.attributes.position.needsUpdate=!0,h.current&&(h.current.geometry.dispose(),h.current.geometry=new s.XJ7(d.current))}},q=()=>{r.current&&(g.current=!1,y.current=-1,r.current.enabled=!0)},X=()=>{if(b.current=requestAnimationFrame(X),!d.current||!m.current||!f.current||!p.current||!x.current||!h.current||!r.current||!t.current||!c.current||!o.current)return;let e=0;if(!g.current){let t=d.current.attributes.position.array,r=m.current.attributes.position.array,n=f.current,a=p.current,l=x.current,i=Array.from(l),u=c.current.userData.neighbors;for(let s=0;s<t.length;s+=3){let i=0;if(s===y.current||l.has(s))continue;let c=t[s]-a[s],o=t[s+1]-a[s+1],d=t[s+2]-a[s+2],m=Math.sqrt(c*c+o*o+d*d),h=k.current;i+=h*m;let p={x:-h*c,y:-h*o,z:-h*d};for(let e of u.get(s)||[]){if(-1===e)continue;let r=t[s]-t[e],n=t[s+1]-t[e+1],l=t[s+2]-t[e+2],u=Math.sqrt(r*r+n*n+l*l),c=a[s]-a[e],o=a[s+1]-a[e+1],d=a[s+2]-a[e+2],m=u-Math.sqrt(c*c+o*o+d*d),h=z.current;i+=h*Math.abs(m);let f=u>1e-6?r/u:0,x=u>1e-6?n/u:0,g=u>1e-6?l/u:0;p.x-=h*m*f,p.y-=h*m*x,p.z-=h*m*g}n[s]+=p.x,n[s+1]+=p.y,n[s+2]+=p.z;let f=A.current;n[s]*=f,n[s+1]*=f,n[s+2]*=f,t[s]+=n[s],t[s+1]+=n[s+1],t[s+2]+=n[s+2];let x=t[s]-a[s],g=t[s+1]-a[s+1],b=t[s+2]-a[s+2],w=Math.sqrt(x*x+g*g+b*b),v=L.current;if(w>v){let e=v/w;t[s]=a[s]+x*e,t[s+1]=a[s+1]+g*e,t[s+2]=a[s+2]+b*e,n[s]*=.5,n[s+1]*=.5,n[s+2]*=.5}e+=i,r[s]=t[s],r[s+1]=t[s+1],r[s+2]=t[s+2]}for(let e of i)t[e]=a[e],t[e+1]=a[e+1],t[e+2]=a[e+2],r[e]=a[e],r[e+1]=a[e+1],r[e+2]=a[e+2],n[e]=0,n[e+1]=0,n[e+2]=0;d.current.attributes.position.needsUpdate=!0,m.current.attributes.position.needsUpdate=!0,h.current&&(h.current.geometry.dispose(),h.current.geometry=new s.XJ7(d.current)),v(t=>{let r=[...t,e];return r.length>600?r.slice(r.length-600):r})}r.current.update(),t.current.render(c.current,o.current)},B=()=>{if(!e.current||!t.current||!o.current)return;let r=e.current,n=r.clientWidth,a=r.clientHeight;if(n>0&&a>0){let e=n/a;o.current.aspect=e,o.current.updateProjectionMatrix(),t.current.setSize(n,a)}};return(0,a.useEffect)(()=>{if(!e.current)return;let n=e.current,a=new s.Z58;c.current=a,a.background=new s.Q1f(0);let u=n.clientWidth/n.clientHeight||1,g=new s.ubm(60,u,.1,1e3);o.current=g,g.position.set(0,0,8),g.lookAt(0,0,0);let y=new l.JeP({antialias:!0});t.current=y,y.setSize(n.clientWidth||100,n.clientHeight||100),n.appendChild(y.domElement);let w=new i.N(g,y.domElement);r.current=w,w.enableDamping=!0,w.dampingFactor=.1,w.enableRotate=!1,w.enablePan=!1;let v=new s.bdM(10,5,20,10);d.current=v;let j=new s.LoY;m.current=j,j.setAttribute("position",v.attributes.position.clone());let N=new s.BH$({color:0xffffff,size:.15,sizeAttenuation:!0}),M=new s.ONl(j,N);a.add(M);let E=new s.mrM({color:8947848,linewidth:1}),F=new s.XJ7(v),R=new s.DXC(F,E);h.current=R,a.add(R);let S=new s.$p8(4210752,1);a.add(S);let C=new s.ZyN(0xffffff,1);C.position.set(0,0,5),a.add(C);let k=new Float32Array(v.attributes.position.array.length);k.set(v.attributes.position.array),p.current=k,f.current=new Float32Array(v.attributes.position.array.length).fill(0);let z=new Set;x.current=z;for(let e=0;e<=10;e++){let t=63*e;z.add(t)}let A=new Map;a.userData.neighbors=A;let L=(e,t,r,n)=>e<0||e>r||t<0||t>n?-1:(t*(r+1)+e)*3;for(let e=0;e<=10;e++)for(let t=0;t<=20;t++){let r=L(t,e,20,10);if(-1===r)continue;let n=[];for(let[r,a]of[[0,-1],[-1,0],[1,0],[0,1]]){let s=L(t+r,e+a,20,10);-1!==s&&n.push(s)}A.set(r,n)}let D=v.attributes.position.array,J=j.attributes.position.array,W=[];for(let e=0;e<=10;e++){let t=(21*e+20)*3;W.push(t)}if(W.length>0){let e=Math.floor(Math.random()*W.length),t=W[e],r=(Math.random()-.5)*.2,n=(Math.random()-.5)*.2;D[t]+=r,D[t+1]+=n,J[t]+=r,J[t+1]+=n,v.attributes.position.needsUpdate=!0,j.attributes.position.needsUpdate=!0}B(),window.addEventListener("resize",B);let Y=y.domElement;return Y.addEventListener("mousedown",P),Y.addEventListener("mousemove",U),Y.addEventListener("mouseup",q),Y.addEventListener("mouseleave",q),X(),()=>{var e,s,l,i,u,c;for(window.removeEventListener("resize",B),Y.removeEventListener("mousedown",P),Y.removeEventListener("mousemove",U),Y.removeEventListener("mouseup",q),Y.removeEventListener("mouseleave",q),b.current&&cancelAnimationFrame(b.current),null===(e=d.current)||void 0===e||e.dispose(),null===(s=m.current)||void 0===s||s.dispose(),null==E||E.dispose(),null==N||N.dispose(),null==F||F.dispose(),null===(l=h.current)||void 0===l||l.geometry.dispose(),null===(i=h.current)||void 0===i||i.material.dispose(),null===(u=r.current)||void 0===u||u.dispose(),null===(c=t.current)||void 0===c||c.dispose();a.children.length>0;)a.remove(a.children[0]);n&&t.current&&n.contains(t.current.domElement)&&n.removeChild(t.current.domElement)}},[]),(0,n.jsxs)("div",{className:"flex flex-col h-full w-full overflow-hidden bg-black text-gray-300",children:[(0,n.jsx)("div",{className:"flex-shrink-0 p-4 flex justify-center",children:(0,n.jsxs)("div",{className:"flex flex-col items-center w-full max-w-[450px] min-w-0",children:[(0,n.jsx)("span",{className:"text-xs text-gray-400 mb-1",children:"Total Internal Force"}),(0,n.jsx)(u,{data:w,height:50,color:"#60a5fa"})]})}),(0,n.jsx)("div",{className:"flex-grow min-h-0 relative w-full",children:(0,n.jsx)("div",{ref:e,className:"absolute inset-0"})}),(0,n.jsxs)("div",{className:"flex-shrink-0 p-4 flex flex-col items-center gap-4 mb-4",children:[(0,n.jsx)("div",{className:"w-full max-w-lg flex justify-center",children:(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 w-full",children:[(0,n.jsx)("label",{htmlFor:"spring",className:"text-xs col-span-1 text-right",children:"Spring:"}),(0,n.jsx)("input",{type:"range",id:"spring",min:"0.001",max:"0.2",step:"0.001",value:j,onChange:e=>N(parseFloat(e.target.value)),className:"col-span-1 h-4 accent-gray-500"}),(0,n.jsx)("span",{className:"text-xs col-span-1",children:j.toFixed(3)}),(0,n.jsx)("label",{htmlFor:"neighborSpring",className:"text-xs col-span-1 text-right",children:"Impact:"}),(0,n.jsx)("input",{type:"range",id:"neighborSpring",min:"0",max:"0.1",step:"0.001",value:M,onChange:e=>E(parseFloat(e.target.value)),className:"col-span-1 h-4 accent-gray-500"}),(0,n.jsx)("span",{className:"text-xs col-span-1",children:M.toFixed(3)}),(0,n.jsx)("label",{htmlFor:"damping",className:"text-xs col-span-1 text-right",children:"Damping:"}),(0,n.jsx)("input",{type:"range",id:"damping",min:"0.8",max:"1.0",step:"0.001",value:F,onChange:e=>R(parseFloat(e.target.value)),className:"col-span-1 h-4 accent-gray-500"}),(0,n.jsx)("span",{className:"text-xs col-span-1",children:F.toFixed(3)}),(0,n.jsx)("label",{htmlFor:"maxDisp",className:"text-xs col-span-1 text-right",children:"Range:"}),(0,n.jsx)("input",{type:"range",id:"maxDisp",min:"0.01",max:"1.0",step:"0.01",value:S,onChange:e=>C(parseFloat(e.target.value)),className:"col-span-1 h-4 accent-gray-500"}),(0,n.jsx)("span",{className:"text-xs col-span-1",children:S.toFixed(2)})]})}),(0,n.jsxs)("div",{className:"w-full flex justify-center gap-4 px-4",children:[(0,n.jsx)("button",{onClick:()=>{if(!d.current||!m.current||!p.current||!f.current||!h.current||!r.current)return;let e=d.current.attributes.position.array,t=m.current.attributes.position.array;e.set(p.current),t.set(p.current),f.current.fill(0),v([]),d.current.attributes.position.needsUpdate=!0,m.current.attributes.position.needsUpdate=!0,h.current.geometry.dispose(),h.current.geometry=new s.XJ7(d.current),g.current=!1,y.current=-1,r.current.enabled=!0,console.log("Simulation reset")},className:"w-full max-w-[120px] px-4 py-1 my-2 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Reset"}),(0,n.jsx)("button",{onClick:()=>{if(!d.current||!m.current)return;let e=d.current.attributes.position.array,t=m.current.attributes.position.array,r=[];for(let e=0;e<=10;e++){let t=(21*e+20)*3;r.push(t)}if(r.length>0){let n=Math.floor(Math.random()*r.length),a=r[n],l=(Math.random()-.5)*.2,i=(Math.random()-.5)*.2;e[a]+=l,e[a+1]+=i,t[a]+=l,t[a+1]+=i,d.current.attributes.position.needsUpdate=!0,m.current.attributes.position.needsUpdate=!0,h.current&&(h.current.geometry.dispose(),h.current.geometry=new s.XJ7(d.current))}},className:"w-full max-w-[120px] px-4 py-1 my-2 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Perturb"})]})]})]})}}}]);